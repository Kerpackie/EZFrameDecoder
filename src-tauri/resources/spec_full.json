{
  "families": [
    {
      "prefix": "<",
      "commands": [
        {
          "letter": "A",
          "description": "Temperature calibration command",
          "items": [
            {
              "name": "header",
              "fields": [
                {
                  "name": "RSAddress",
                  "len": 2,
                  "base": 16,
                  "type": "u8",
                  "description": "Device address on RS-485 bus"
                }
              ]
            },
            {
              "name": "fields",
              "fields": [
                {
                  "name": "Polarity",
                  "len": 1,
                  "base": 10,
                  "type": "u8",
                  "description": "Polarity (0 = positive, 1 = negative)"
                },
                {
                  "name": "Offset",
                  "len": 3,
                  "base": 16,
                  "type": "u16",
                  "description": "Temperature offset (hex)"
                },
                {
                  "name": "TempGain",
                  "len": 4,
                  "base": 16,
                  "type": "u16",
                  "description": "Temperature gain (hex)"
                },
                {
                  "name": "Reserved",
                  "len": 3,
                  "base": 16,
                  "type": "u16",
                  "description": "Reserved"
                },
                {
                  "name": "SetPointStart",
                  "len": 1,
                  "base": 10,
                  "type": "bool",
                  "description": "Set-point start flag"
                },
                {
                  "name": "PowerUpDelay",
                  "len": 4,
                  "base": 16,
                  "type": "u16",
                  "description": "Power-up delay (hex)"
                }
              ]
            }
          ]
        },
        {
          "letter": "C",
          "description": "Configuration / control commands selected by 16-bit opcode",
          "items": [
            {
              "name": "header",
              "fields": [
                {
                  "name": "RSAddress",
                  "len": 2,
                  "base": 16,
                  "type": "u8",
                  "description": "Device address on RS-485 bus"
                },
                {
                  "name": "Opcode",
                  "len": 4,
                  "base": 16,
                  "type": "u16",
                  "description": "Operation selector"
                }
              ]
            },
            {
              "switch": "Opcode",
              "cases": {
                "0x0903": {
                  "description": "Set program-ID on board",
                  "groups": [
                    {
                      "name": "payload",
                      "fields": [
                        {
                          "name": "Reserved",
                          "len": 12,
                          "base": 16,
                          "type": "u64",
                          "description": "Unused padding"
                        }
                      ]
                    }
                  ]
                },
                "0x1700": {
                  "description": "C17 — special device command",
                  "groups": [
                    {
                      "name": "payload",
                      "fields": [
                        {
                          "name": "Reserved",
                          "len": 12,
                          "base": 16,
                          "type": "u64",
                          "description": "Unused padding"
                        }
                      ]
                    }
                  ]
                },
                "0x2100": {
                  "description": "C21 — special device command",
                  "groups": [
                    {
                      "name": "payload",
                      "fields": [
                        {
                          "name": "Reserved",
                          "len": 12,
                          "base": 16,
                          "type": "u64",
                          "description": "Unused padding"
                        }
                      ]
                    }
                  ]
                },
                "0x5002": {
                  "description": "Open driver",
                  "groups": [
                    {
                      "name": "payload",
                      "fields": [
                        {
                          "name": "Reserved",
                          "len": 12,
                          "base": 16,
                          "type": "u64",
                          "description": "Unused padding"
                        }
                      ]
                    }
                  ]
                },
                "0x5003": {
                  "description": "Close driver + get checksum",
                  "groups": [
                    {
                      "name": "payload",
                      "fields": [
                        {
                          "name": "Reserved",
                          "len": 12,
                          "base": 16,
                          "type": "u64",
                          "description": "Unused padding"
                        }
                      ]
                    }
                  ]
                }
              },
              "default": {
                "description": "Unrecognised C-opcode",
                "groups": [
                  {
                    "name": "payload",
                    "fields": [
                      {
                        "name": "Raw",
                        "len": 12,
                        "base": 16,
                        "type": "u64",
                        "description": "Raw payload bytes"
                      }
                    ]
                  }
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}
